from typing import List
from heapq import heapify,heappop,heappush

class Solution:
    def swimInWater(self, grid: List[List[int]]) -> int:
        lenx = len(grid[0]); max_x = lenx - 1
        leny = len(grid); max_y = leny - 1

        heap = [(grid[max_y][max_x], max_x, max_y)]
        heapify(heap)
        visited = [[False]*lenx for _ in range(leny)]
        visited[max_y][max_x] = True

        while heap:
            h,x,y = heappop(heap)
            if x == 0 and y == 0:
                return h
                       
            for i,j in [(x+1,y), (x-1,y), (x,y+1), (x,y-1)]:
                if 0<=i<=max_x and 0<=j<=max_y and (i,j) and not visited[j][i]:
                    heappush(heap, (max(h,grid[j][i]),i,j))
                    visited[j][i] = True

        assert False


engine = Solution()


grid = [[0,1,2,3,4],[24,23,22,21,5],[12,13,14,15,16],[11,17,18,19,20],[10,9,8,7,6]]
print(engine.swimInWater(grid), 16)


grid = [[2392,1493,1924,60,705,766,1869,991,1554,1768,61,105,133,560,1825,585,2023,579,569,1756,79,199,1773,2103,63,1689,98,2364,2105,341,725,447,736,2075,620,1005,812,641,100,1142,2126,200,515,2063,1560,419,1067,2372,1339],[681,455,527,1373,2192,1760,1996,510,972,1929,2140,2284,998,2254,1945,2242,522,1533,1985,234,1460,861,577,1291,1794,2208,661,798,756,49,1550,1856,1608,453,1432,843,2193,1488,1369,2205,915,921,292,2201,2237,899,1675,870,2050],[2263,51,1529,657,1269,463,2147,2289,1789,2315,440,70,1209,1138,408,158,1028,734,1860,1645,12,2198,1508,595,2359,251,874,1365,1743,570,275,1653,1137,1676,2110,383,1642,1635,1955,841,104,1029,2258,1486,788,879,1699,2307,955],[2151,1416,416,2308,2117,2024,1652,1619,1571,611,423,735,1878,1871,1087,1626,663,322,779,162,1459,880,2111,1317,1592,1482,2008,2190,375,439,1054,242,1155,621,437,316,953,2215,825,1667,1343,2152,2074,715,1126,1086,21,503,519],[1409,1951,1904,731,1194,1986,2355,759,1389,230,764,598,1401,633,2310,703,1557,805,77,601,1787,1158,744,1238,961,855,50,2360,869,712,1287,1205,2006,2261,2159,2282,839,1151,429,1723,11,26,607,617,1923,432,787,531,1746],[471,2207,2362,794,1357,1007,2395,2109,151,1186,14,1128,903,813,1001,2367,908,493,1160,1494,476,2022,1597,1683,2128,2283,1391,244,975,1284,904,871,179,497,523,264,1920,2168,2296,23,340,1032,1551,1791,1011,2183,2072,1354,117],[282,2220,443,1769,1673,86,511,780,2338,1174,361,1216,2287,1972,2210,958,16,637,1308,1147,1961,2391,2293,1833,649,2059,549,2277,1095,420,1456,1798,2071,1835,232,737,1467,1224,829,4,1611,300,1048,1006,115,1519,466,2321,1074],[2247,819,1883,1690,1143,2077,2100,147,1623,1214,1968,2066,1734,1646,1621,2124,1179,1998,860,1457,384,1942,116,127,409,1026,660,2094,1960,1806,2076,1358,567,157,2113,1654,1124,2196,1353,1285,1336,2044,1582,1523,572,1091,1680,1846,2222],[668,2223,202,900,227,1921,308,1177,444,1771,650,2145,631,1262,563,1503,1538,1729,2121,1385,1670,1249,2040,1937,1485,1259,465,1332,613,1397,2374,2333,804,1885,144,665,1117,1125,1849,1063,1081,933,1090,2316,2339,2324,95,778,2028],[1009,1211,2186,1531,263,469,831,1318,1014,258,2382,1712,1246,68,1449,2273,417,1105,2270,2204,1407,1394,2330,1324,1532,1321,2107,367,1435,1015,2102,1393,555,1944,935,1290,1019,1922,268,1764,2080,2142,985,1926,1190,206,1573,1492,2112],[1297,1858,2091,411,2184,769,1102,696,2369,2228,32,1987,501,388,62,208,821,1381,228,297,507,1637,1725,20,314,71,1355,1410,1816,1800,982,1377,1281,574,1228,2104,2085,1468,412,399,1681,513,1304,2248,452,754,1415,2156,1559],[461,2122,2301,2165,1600,1433,2225,593,1059,1588,898,373,1707,978,2169,2335,2387,2199,1796,1182,1580,1594,1062,400,483,320,1314,962,2020,47,213,130,2246,2108,80,863,2009,524,1638,1364,1414,1534,2377,917,445,1978,391,517,1516],[155,2216,2400,540,406,605,995,2340,992,2309,2099,1016,1719,414,583,222,2052,2279,1344,2280,571,505,1072,1230,1237,495,1378,1057,289,2029,1867,1119,1915,625,291,1995,2295,1935,382,1820,2182,96,1210,1022,290,828,2149,1599,1783],[106,2388,150,1544,1651,2187,237,303,114,293,2162,1505,1605,1569,73,1097,387,746,390,1064,1948,944,2269,902,1827,2084,475,867,131,1130,1164,1140,1607,436,1678,910,848,1082,686,1330,2229,1017,514,2259,946,1615,2185,2095,66],[101,255,810,928,254,1033,55,1751,2232,2015,1957,603,1484,833,2214,1793,1212,270,901,2141,1441,1774,1853,2046,1185,2115,1900,651,674,2219,979,689,1144,1283,2288,1694,323,1122,1954,1388,2318,1556,1094,526,1606,528,433,1299,907],[1692,1567,534,58,1976,351,1328,1189,1577,924,1984,1876,695,1819,1085,2313,2373,1994,670,1206,782,1305,1537,460,149,190,1320,2221,250,1163,1135,226,1114,220,44,28,920,1911,2019,671,704,335,1732,486,1830,1446,1925,201,722],[929,707,1184,1682,836,851,988,2260,330,2088,404,659,1100,2274,586,1859,2399,941,1886,504,615,675,2060,1686,999,740,2354,1222,124,468,676,1650,1162,1473,45,1742,1331,344,553,713,1873,64,321,1171,1836,65,2177,2238,691],[236,906,2153,1438,2014,883,1832,993,239,398,664,547,1687,1962,1161,464,1481,1808,331,1770,1971,1294,1196,1012,1591,1053,2285,811,1362,1839,2101,947,1239,1220,1868,1298,1278,6,2381,2239,1437,1840,1176,1893,532,937,709,2368,1980],[1018,1892,792,1750,2175,166,160,1966,2379,834,418,938,1973,2226,1887,312,368,1120,1386,422,204,1989,1039,1927,862,112,421,1195,1153,1739,1131,1337,1817,1669,1424,1842,2144,2038,853,247,1639,1663,1918,1829,1741,974,1255,1049,2061],[1934,2347,1392,857,882,588,1335,2127,1874,164,1843,565,1340,1282,392,897,1905,743,945,1664,1235,1333,2032,500,2078,85,492,276,2337,1444,817,142,72,1581,2178,1023,875,1404,700,1514,789,163,169,2235,1863,369,1188,337,1168],[2231,2082,2081,1932,1896,1841,136,596,129,7,1475,808,720,1089,1342,1641,1080,564,304,365,1695,728,2021,1030,83,1542,1178,371,2016,1540,775,125,1347,1640,324,496,218,770,629,1509,1722,260,332,74,1051,1270,525,783,893],[2396,159,279,39,283,1429,1727,342,1436,1967,911,1688,2350,1946,1815,2332,473,1462,745,1327,1448,57,1367,1720,2327,107,389,692,802,1864,698,2195,1099,1390,1293,2342,741,1603,1593,229,2172,1060,327,203,82,113,1696,280,1753],[1141,610,761,1899,1490,1463,1430,697,606,2096,138,266,934,581,311,2191,2356,54,1396,2058,145,1450,119,2353,653,533,1200,1850,1405,1598,78,981,1146,905,1744,1136,2370,1884,1384,1470,2118,854,753,1943,1110,803,1632,196,1169],[711,92,1370,1795,224,173,760,968,838,1104,1547,777,1672,1231,2092,1497,2390,1256,889,2358,231,918,141,1303,2230,59,474,1154,1376,41,865,364,1993,1323,313,1502,374,1221,165,1778,1207,1368,499,1055,635,1268,2256,1431,752],[699,648,2394,1361,1633,1754,301,1724,1084,912,269,881,1250,584,822,498,2129,781,212,1844,462,2051,1175,2265,509,10,407,1630,1933,729,2363,46,139,683,395,1914,885,348,370,1530,1785,2064,217,1679,91,884,2048,2026,1360],[866,216,2303,1740,2244,846,1254,835,1671,2272,415,1831,288,108,2275,110,185,177,949,2245,1781,482,1088,2180,1627,591,806,1145,1181,727,1838,1040,516,1583,642,219,544,2331,353,1261,1999,2017,1586,1526,1045,29,1421,240,1157],[89,2251,2249,612,53,484,1403,48,1595,214,1428,1543,459,1325,666,118,1601,1992,2119,458,1895,167,2136,1038,1311,1710,576,2098,1928,2349,1520,1109,2036,2398,772,284,733,723,235,345,1187,2055,1763,749,193,1970,1726,684,1997],[2114,521,90,1263,1804,252,858,1837,1624,1906,438,807,1658,2328,377,1852,467,435,343,922,0,1747,1341,1434,1076,156,1069,2267,273,1648,22,1150,1043,785,814,137,1938,2042,1749,2290,2133,427,1495,2179,359,1203,1167,81,393],[2001,1826,1202,765,1814,1289,102,449,1766,2,286,1708,892,2138,1665,784,996,1351,1950,271,1066,1579,2134,1302,1075,1402,2161,2200,750,630,1913,1489,2361,1193,143,1907,1903,1610,748,2276,1649,1363,175,580,52,1112,1498,31,926],[305,325,1636,1549,1408,1348,2123,742,986,1511,2116,1242,1939,1513,19,1890,2160,1507,1625,2268,662,724,747,487,76,2305,2213,557,895,1572,2120,616,645,2243,1759,1821,1802,1801,378,1666,1047,2378,609,211,1698,1469,1247,1524,128],[1046,512,939,148,2062,192,2073,1535,1655,1452,646,626,1738,442,672,886,182,1545,1563,352,850,639,1422,1241,2365,2346,1613,1949,1931,913,34,1797,1661,677,1,967,627,1936,36,638,385,446,1093,818,1271,336,800,5,479],[1574,1862,952,1108,403,1525,189,701,35,1300,973,1647,2325,2334,490,2326,1677,2329,2234,1002,246,989,1548,1528,976,820,1517,3,1812,2255,1912,656,1969,356,1813,1248,1866,1561,195,599,1958,386,1880,673,2176,558,872,1371,1521],[1383,830,1423,718,2012,56,1703,1705,536,1218,2281,1506,1964,997,454,1400,2167,655,688,682,1882,1875,1824,1965,1204,426,1757,1276,24,1454,1132,43,333,299,2155,2173,1455,2043,561,2079,2130,1476,2299,1380,488,210,608,816,1491],[1266,1058,2202,1761,1345,152,1050,2297,2306,1701,1447,643,2314,1217,690,1338,207,1706,1564,1417,1201,42,2158,837,277,1316,1767,1546,1501,1312,1442,1359,1346,2033,1319,67,253,2224,529,1861,1387,942,1752,1306,360,931,730,1622,168],[950,679,1576,126,680,624,1565,636,1382,2197,1288,719,2386,109,296,694,1008,379,1159,1910,1685,1123,1589,1515,221,1897,758,693,1909,956,187,281,2083,1702,470,1614,197,628,774,1010,824,582,1173,959,1981,1199,923,154,1660],[1644,852,2002,539,1273,2035,1777,551,1425,241,2302,1372,644,480,245,2007,329,1788,18,1041,943,1295,1479,2054,632,2049,844,1834,751,317,180,876,1870,755,552,2188,1042,559,1697,1244,2294,140,310,1349,441,262,1418,2139,2166],[1313,405,1735,328,1264,1809,135,1472,1536,1165,1772,1166,1077,274,372,1406,191,502,223,334,2317,940,845,349,1478,1257,146,2137,1568,1499,1959,381,122,2057,1898,827,1674,1711,1578,767,619,1192,2211,256,1786,1974,1149,658,1709],[1296,614,2257,472,1803,1025,1539,1765,1020,413,971,2146,1570,1818,1748,346,2027,1107,1700,257,1465,1805,1716,966,295,1134,1366,1504,1496,111,537,1170,1180,1522,796,1940,2397,2209,194,1628,1718,1440,1590,1226,1453,2041,556,2045,708],[1881,1183,2376,2319,1267,980,1782,1477,1103,984,2004,1061,1889,134,706,1419,2090,732,1427,1990,1704,1784,604,896,2106,1721,1078,535,546,562,362,30,2357,1612,25,2069,1662,478,1541,99,1412,815,1629,188,763,687,2031,859,602],[170,1631,2135,1395,1399,983,793,15,1000,1036,1714,1745,2053,1602,394,1052,717,456,2089,640,1618,285,1617,1275,448,354,702,1902,1252,209,1620,771,75,1857,1198,716,481,2266,267,1776,1156,428,347,2341,1487,1762,9,2227,1930],[1941,2352,1021,489,916,1822,1083,1451,518,530,1243,494,864,542,2236,1013,840,856,936,1139,2385,873,1277,832,1823,2217,1309,1129,37,773,969,930,205,1982,302,176,1977,1510,1483,2181,2292,987,1413,153,1894,1736,2067,589,1790],[965,791,888,809,2241,8,1315,339,1908,1461,2300,1596,181,2351,1280,1236,450,1851,2218,1233,909,2013,2194,1092,1031,566,1963,2132,2163,1684,434,1234,1096,1213,575,1854,198,40,410,990,1979,123,1127,17,1027,738,1604,2154,578],[2065,1585,2086,261,957,485,762,2320,1474,1208,307,587,425,172,2311,932,1191,573,1375,2212,225,652,2384,594,1730,2252,592,358,786,1799,678,38,1847,1133,1379,171,1071,184,319,2087,951,1443,1003,2030,1527,669,1865,1755,890],[1691,622,1500,2170,1260,1292,2097,887,1947,1113,2039,1464,1919,618,2011,1240,2323,797,1223,1480,94,13,380,1668,2056,1848,2304,249,238,2375,402,1279,1229,355,2125,1916,1512,178,2271,259,1609,1445,69,714,1426,891,2291,1891,1352],[842,424,2047,2240,318,265,33,121,120,84,600,186,849,1350,1975,1587,457,1004,1034,823,97,132,1659,1326,1657,1227,994,1731,2143,1056,2366,401,1118,1197,1232,508,914,1643,1634,1307,233,491,2150,1810,1552,2264,215,1656,1251],[894,960,1518,1775,2034,963,103,1584,1553,2233,801,1098,2171,357,1065,538,1953,877,2253,366,1334,1420,1780,396,1079,1301,315,2131,2250,2206,2298,543,1274,272,1558,1219,93,1101,2389,287,161,1286,2203,1956,1073,1356,2005,1148,554],[1258,1877,2068,1811,1872,1466,919,1106,1471,1758,338,1693,568,757,2164,925,634,623,964,1458,183,2393,430,1779,847,868,2189,397,1828,1044,954,597,1737,27,2383,927,647,2343,1901,667,1111,977,88,2000,1792,298,1616,2093,2371],[1245,1845,2344,1037,1566,1070,350,654,685,431,1329,795,2322,2070,451,1713,726,970,1024,878,1272,1068,520,306,1917,1879,1115,326,1398,506,1265,1035,2148,948,1439,174,590,2286,294,2037,2018,1310,1715,1733,1374,1728,1172,1807,826],[2262,1225,87,376,1253,1555,1575,2025,2336,1116,721,1121,768,1991,1562,2345,1988,545,550,1717,2312,1855,1411,2010,248,477,1215,1888,278,790,799,2174,1952,309,739,243,2157,1322,1152,548,776,2380,541,2278,2003,710,1983,2348,363]]
print(len(grid))
print(engine.swimInWater(grid), 16)
